name: 'Generate GitHub Token'
description: 'Generates a GitHub token using a private key, app ID, and installation ID'

inputs:
  private_key:
    description: 'Path to the private key file'
    required: false

outputs:
  github_token:
    description: 'Generated GitHub token'

runs:
  using: 'composite'
  steps:
    - name: key export and set up
      shell: bash
      run: | 
        echo "${{ inputs.private_key }}" > key.pem

    - name: Execute Python script
      shell: bash
      run: |
        python gh_token/script.py key.pem 903110 50999118 >> token.txt
      id: generate_token

    - name: Store GitHub Token as Secret
      shell: bash
      id: generate_token_cat
      run: |
        cat token.txt
        echo "GHS_TOKEN=${{ steps.generate_token_cat.outputs }}"
        echo "GHS_TOKEN=${{ steps.generate_token_cat.outputs.token }}"
        echo "GHS_TOKEN=${{ steps.generate_token_cat.outputs.* }}"
        echo "GHS_TOKEN=${{ steps.generate_token_cat.outputs }}" >> $GITHUB_ENV
